{
  "type": "v1/system",

  "components": {
    "api": {
      "type": "v1/service",
      "description": "Private service",

      "ports": {
        "80": {
          "protocol": "HTTP",
          "external_access": { "public": true }
        }
      },

      "build": {
        "git_repository": {
          "url": "git@github.com:mlab-lattice/api-services.git",
          "commit": "f734abeaa290fb3bae015ea489b110c7c244c342",
          "ssh_key": "/:git-ssh-key"
        },
        "language": "node:carbon",
        "command": ["cd private && npm install"]
      },

      "exec": {
        "command": [
          "node",
          "private/lib/index.js"
        ],
        "environment": {
          "LATTICE_CORE_DB_URI": {"secret": "/:core-db-uri"},
          "LATTICE_AUDIT_DB_URI": {"secret": "/:audit-db-uri"},
          "LATTICE_PAGERDUTY_ROUTING_KEY": {"secret": "/:pagerduty-routing-key"},
          "LATTICE_SENDGRID_API_KEY": {"secret": "sendgrid-api-key"},
          "LATTICE_EXTERNAL_ADDRESS": "https://staging.lattice.mlab.com"
        }
      },

      "num_instances": 1,
      "node_pool": { "instance_type": "t2.small", "num_instances": 1 }
    }
  }
}
